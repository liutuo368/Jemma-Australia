<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Search results</title>

    <link rel="stylesheet" type="text/css" href="../../static/CSS/home.css">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.16/dist/css/bootstrap-select.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.16/dist/js/bootstrap-select.min.js"></script>

    <!-- (Optional) Latest compiled and minified JavaScript translation files -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.16/dist/js/i18n/defaults-*.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            var menu_name;

            if({{ login_status|safe }}) {
                menu_name = "top_menu_sign_in";
            } else {
                menu_name = "top_menu_without_sign_in";
            }
            $("#menu").load("top_menu_sign_in");
            $("#menu").load(menu_name);

            $("#footer").load("footer");
        });

        function onclick_tradie(tradie_id) {
             if (typeof tradie_id == 'undefined') {
                tradie_iframe.src = "no_tradie_found_error";
            }
            else {
                 tradie_iframe.src = 'tradie_detail?tradie_id=' + tradie_id + '&job_type={{ job_type }}';
             }
        }
        window.onload = function() {
            onclick_tradie({{ tradie_list.0.0.tradie.myUser.id }});
        }

    </script>

    <style>
        * {
            margin: 0;
        }

        html, body {
            height: 100%;
        }

        .page-wrap {
            min-height: 100%;
            /* equal to footer height */
            margin-bottom: -142px;
        }

        .page-wrap:after {
            content: "";
            display: block;
        }

        .page-footer, .page-wrap:after {
            height: 142px;
        }

        .tradie-card {
            background-color: #ffffff;
            height: 140px;
        }

        .user-information-box {
            text-align: left;
            font-size: 16px;
            line-height: 16px;
            padding-top: 10px;
        }

        .username {
            font-weight: bold;
            font-size: 20px;
            line-height: 20px;
            height: 20px;
            overflow: hidden;
        }

        .hour-rate {
            color: dimgrey;
            font-weight: bold;
            text-align: right;
            overflow: hidden;
            padding-top: 2px;
        }

        .review {
            color: dimgrey;
            font-weight: bold;
        }

        .art-img {
            float: left;
            width: 112px;
            height: 146px;
            padding-right: 10px;
        }
    </style>
</head>

<body>

<div id='menu'></div>

<div class="page-wrap">
    <!--Search bar-->
    <form action="/customer_search_result" method="get">
        {% csrf_token %}
    <div class="row mt-3 text-center mb-5 justify-content-center align-items-center" style="height: 50px;">
        <div class="col-md-1"></div>
        <a><i class="fa fa-search p-1"></i></a>
        <div class="col-md-3">
            <select name="job_type" id="job-keyword-selection" class="selectpicker" multiple
                    data-max-options="1" title="Job keywords" data-dropup-auto="false"
                    data-live-search="true" data-width="100%" data-container=".div" required>
                <optgroup label="A">
                    <option value="1">Aircon Mechanic</option>
                </optgroup>
                <optgroup label="B">
                    <option value="2">Brick Layer</option>
                </optgroup>
                <optgroup label="C">
                    <option value="3">Carpenter</option>
                    <option value="4">Carpet Layer</option>
                </optgroup>
                <optgroup label="D">
                    <option>Decking</option>
                </optgroup>
                <optgroup label="E">
                    <option>Electrician</option>
                </optgroup>
                <optgroup label="F">
                    <option>Fencing</option>
                </optgroup>
                <optgroup label="G">
                    <option>Gas Plumber</option>
                    <option>Glazier</option>
                </optgroup>
                <optgroup label="H">
                    <option>Hair and Makeup</option>
                    <option>Home Renovation</option>
                </optgroup>
                <optgroup label="I">
                    <option>Insulation</option>
                </optgroup>
            </select>
        </div>

        <a><i class="fa fa-location-arrow p-1" aria-hidden="true"></i></a>
        <div class="col-md-3">
            <select name="location" id="location-selection" class="selectpicker" multiple
                    data-max-options="1" title="Locations" data-dropup-auto="false"
                    data-live-search="true" data-width="100%" data-container=".div" required>
                <optgroup label="A">
                    <option>Acton</option>
                    <option>Aranda</option>
                </optgroup>
                <optgroup label="B">
                    <option>Belconnen</option>
                    <option>Bonner</option>
                    <option>Braddon</option>
                </optgroup>
                <optgroup label="C">
                    <option value="3">Calwell</option>
                    <option value="3">Canberra</option>
                    <option value="4">Charnwood</option>
                    <option value="4">Crace</option>
                </optgroup>
                <optgroup label="D">
                    <option>Dickson</option>
                    <option>Deakin</option>
                    <option>Downer</option>
                </optgroup>
                <optgroup label="E">
                    <option>Evatt</option>
                </optgroup>
                <optgroup label="F">
                    <option>Florey</option>
                    <option>Forde</option>
                    <option>Forrest</option>
                    <option>Franklin</option>
                    <option>Fyshwick</option>
                </optgroup>
                <optgroup label="G">
                    <option>Garran</option>
                    <option>Greenway</option>
                    <option>Griffith</option>
                    <option>Gungahlin</option>
                </optgroup>
                <optgroup label="H">
                    <option>Harrison</option>
                    <option>Hawker</option>
                    <option>Holt</option>
                </optgroup>
                <optgroup label="I">
                    <option>Isabella Plains</option>
                </optgroup>
                <optgroup label="J">
                    <option>Jacka</option>
                </optgroup>
                <optgroup label="K">
                    <option>Kaleen</option>
                    <option>Kambah</option>
                    <option>Kingsrib</option>
                </optgroup>
                <optgroup label="L">
                    <option>Latham</option>
                    <option>Lyneham</option>
                </optgroup>
            </select>
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-dark btn-round">
                Search
            </button>
        </div>
    </div>
    </form>
    <!--Search results section-->
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-4">
            <table class="table table-hover">
                {% for var, rating_number, rating in tradie_list %}
                <tr class="tradie-card" onClick="onclick_tradie('{{ var.tradie.myUser.id }}')">
                    <td class="row1">
                        <img class="art-img" src="{{ var.tradie.myUser.user_hp.url }}" alt="user picture">
                        <div class="user-information-box">
                            <div class="row">
                                <p class="username col-md pl-0">{{ var.tradie.first_name }} {{ var.tradie.last_name }}</p>
                                <p class="hour-rate col-md">${{ var.price }}/hour</p>
                            </div>
                            <p class="user-location">{{ var.tradie.suburb }} {{ var.tradie.state }}</p>
                            <p class="join-time">Joined since {{ var.tradie.joinDate.year }}</p>
                            <div class="row review">
                                <p class="col-md pl-0">{{ rating_number }} Reviews</p>
                                <p class="col-md">{{ rating }}/5</p>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}

            </table>
        </div>

        <div class="col-md-4 border" style="height: 862px; padding: 0; overflow: hidden;">
            <iframe id="tradie_iframe" frameborder="0" style="height: 100%; width: 100%; " ></iframe>
        </div>

        <div class="col-md-2"></div>
    </div>

</div>

<div id="footer" class="page-footer"></div>

<script>
    $('.selectpicker').selectpicker();
</script>
</body>
</html>